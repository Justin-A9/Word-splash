Index: app/src/main/java/com/example/squash/fragments/Profile.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.squash.fragments\r\n\r\nimport android.graphics.BitmapFactory\r\nimport android.net.Uri\r\nimport android.os.Bundle\r\nimport android.view.LayoutInflater\r\nimport android.view.View\r\nimport android.view.ViewGroup\r\nimport androidx.fragment.app.Fragment\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.fragment.NavHostFragment\r\nimport com.example.squash.R\r\nimport com.example.squash.databinding.FragmentProfileBinding\r\nimport com.example.squash.datasource.PreferenceManager\r\nimport com.example.squash.datasource.Users\r\nimport com.google.firebase.auth.FirebaseAuth\r\nimport com.google.firebase.firestore.FirebaseFirestore\r\nimport com.google.firebase.ktx.Firebase\r\nimport com.google.firebase.storage.ktx.storage\r\nimport kotlinx.coroutines.CoroutineScope\r\nimport kotlinx.coroutines.Dispatchers\r\nimport kotlinx.coroutines.launch\r\nimport kotlinx.coroutines.tasks.await\r\nimport kotlinx.coroutines.withContext\r\n\r\n\r\nclass Profile : Fragment() {\r\n\r\n    private lateinit var navController: NavController\r\n    private lateinit var binding: FragmentProfileBinding\r\n    var preferenceManager: PreferenceManager? = null\r\n    private var db: FirebaseFirestore? = null\r\n    private var userId: String? = null\r\n    private lateinit var auth: FirebaseAuth\r\n    private var imageRef = Firebase.storage.reference\r\n\r\n\r\n    override fun onCreateView(\r\n        inflater: LayoutInflater, container: ViewGroup?,\r\n        savedInstanceState: Bundle?\r\n    ): View? {\r\n        binding = FragmentProfileBinding.inflate(layoutInflater, container, false)\r\n        preferenceManager?.preferenceManager(requireContext())\r\n        navController = NavHostFragment.findNavController(this)\r\n\r\n        auth = FirebaseAuth.getInstance()\r\n        val user = auth.currentUser?.email\r\n\r\n\r\n        if (user != null) {\r\n            downloadImage(user)\r\n        }\r\n\r\n        val currentUser = FirebaseAuth.getInstance().currentUser\r\n        db = FirebaseFirestore.getInstance()\r\n        if (currentUser != null) {\r\n            userId = currentUser.uid\r\n        }\r\n\r\n\r\n        val docRef = db?.collection(\"users\")?.document(userId!!)\r\n\r\n        docRef?.get()?.addOnSuccessListener { documentSnapshot ->\r\n            val user = documentSnapshot.toObject(Users::class.java)\r\n            binding.profileEmail.text = \" ${user?.email}\"\r\n            binding.profileName.text = \" ${user?.username}\"\r\n            binding.about.text = \" ${user?.about}\"\r\n\r\n\r\n            binding.backBtn.setOnClickListener {\r\n                navController.navigate(R.id.action_profile_to_menuFragment)\r\n            }\r\n            binding.editProfileBTN.setOnClickListener {\r\n                val action = ProfileDirections.actionProfileToEditProfile(user!!)\r\n                navController.navigate(action)\r\n            }\r\n\r\n//            val args = this.arguments\r\n//            val currentImage = args?.getString(\"profileImage\")\r\n//\r\n//            if (currentImage != null) {\r\n//                val fileUri = Uri.parse(currentImage)\r\n//                binding.imageProfile.setImageURI(fileUri)\r\n//            }\r\n\r\n\r\n        }\r\n        return binding.root\r\n    }\r\n\r\n\r\n    private fun downloadImage(filename: String)= CoroutineScope(Dispatchers.IO).launch {\r\n        try {\r\n            val maxDownloadSize = 5L * 1024 * 1024\r\n            val bytes = imageRef.child(\"images/$filename\").getBytes(maxDownloadSize).await()\r\n            val bmp = BitmapFactory.decodeByteArray(bytes, 0,bytes.size)\r\n            withContext(Dispatchers.Main){\r\n                binding.imageProfile.setImageBitmap(bmp)\r\n            }\r\n\r\n        } catch (e: Exception) {\r\n\r\n        }\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/squash/fragments/Profile.kt b/app/src/main/java/com/example/squash/fragments/Profile.kt
--- a/app/src/main/java/com/example/squash/fragments/Profile.kt	(revision a5cb4327bd2b0dcde8102fb87e856d11d6a2afe0)
+++ b/app/src/main/java/com/example/squash/fragments/Profile.kt	(date 1665862700472)
@@ -1,7 +1,6 @@
 package com.example.squash.fragments
 
 import android.graphics.BitmapFactory
-import android.net.Uri
 import android.os.Bundle
 import android.view.LayoutInflater
 import android.view.View
